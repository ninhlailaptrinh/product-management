extends ../../layouts/default.pug
include ../../mixins/alert.pug
include ../../mixins/select-tree.pug

block main
  +alert-ok(5000)
  +alert-err(5000)

  h1.mb-4 Sửa sản phẩm

  if product
    form#form-edit-product(
      action=`${prefixAdmin}/products/edit/${product._id}?_method=PATCH`,
      method="POST",
      enctype="multipart/form-data"
    )
      //- Tiêu đề
      .form-group
        label(for="title") Tiêu đề
        input#title.form-control(type="text", name="title", required, value=product.title)
      //- Chon danh muc 
    .form-group.mb-3
      label.form-label(for="product_category_id") Danh mục
      select#product_category_id.form-control(name="product_category_id")
        option(value="") -- Chọn danh mục --
        if (category)
          +select-tree(category, 1 , product.product_category_id)
      //- Mô tả
      .form-group
        label(for="desc") Mô tả
        textarea#desc.form-control(name="description", rows="5") #{ product.description }

      //- Giá
      .form-group
        label(for="price") Giá
        input#price.form-control(type="number", name="price", value=product.price, min="0")

      //- % Giảm giá
      .form-group
        label(for="discount") % Giảm giá
        input#discount.form-control(
          type="number",
          name="discountPercentage",
          value=product.discountPercentage,
          min="0"
        )

      //- Số lượng
      .form-group
        label(for="stock") Số lượng
        input#stock.form-control(type="number", name="stock", value=product.stock, min="0")

      //- Ảnh
      .form-group(upload-image)
        label(for="thumbnail") Ảnh
        input#thumbnail.form-control-file(type="file", name="thumbnail", accept="image/*", upload-image-input)
        if product.thumbnail
          img.image-preview(
            src=product.thumbnail,
            upload-image-preview,
            alt="Ảnh sản phẩm",
            style="width: 150px; margin-top: 10px"
          )

      //- Vị trí
      .form-group
        label(for="position") Vị trí
        input#position.form-control(type="number", name="position", value=product.position, min="1")

      //- Trạng thái
      .form-group.form-check.form-check-inline
        input#statusActive.form-check-input(
          type="radio",
          name="status",
          value="active",
          checked=product.status === "active"
        )
        label.form-check-label(for="statusActive") Hoạt động

      .form-group.form-check.form-check-inline
        input#statusInactive.form-check-input(
          type="radio",
          name="status",
          value="inactive",
          checked=product.status === "inactive"
        )
        label.form-check-label(for="statusInactive") Dừng hoạt động

      //- Nút submit
      .form-group
        button.btn.btn-primary(type="submit") Lưu lại
  else
    p Không có thông tin sản phẩm.

  script(src="/admin/js/product.js")
